const fs = require('fs');
const { pad } = require('../const/func.js');
const { textConfirmation } = require('../embeds/textConfirmation.js');

async function checkBirthday() {
  const filePath = 'lib/localdb/birthday.json';

  // Get today's format date in dd-mm
  let today = new Date();
  let mm = today.getMonth() + 1;
  let dd = today.getDate();
  let formattedToday = pad(dd) + '-' + pad(mm);

  // Read json to check someone's birthday
  let jsonData = JSON.parse(fs.readFileSync(filePath));
  let checkKey = formattedToday in jsonData;

  if (checkKey) {
    discordUser = jsonData[formattedToday].discordID;
    let msg = `Happy Birthday, <@${discordUser}>! Semoga panjang umur, diberi umur yang berkah, dan bisa menjadi pribadi yang lebih baik.`;
    let showEmbed = await textConfirmation(msg, "birhtday");
    return showEmbed;
  } else {
    return false;
  }
}

module.exports = { checkBirthday };